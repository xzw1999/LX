(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-273dc74f"],{"1d84":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"i-layout-page-header"},[a("div",{staticClass:"i-layout-page-header"},[a("span",{staticClass:"ivu-page-header-title"},[e._v(e._s(e.$route.meta.title))])])]),a("Card",{staticClass:"ivu-mt",attrs:{bordered:!1,"dis-hover":""}},[a("Form",{attrs:{model:e.gradeFrom,"label-width":e.labelWidth,"label-position":e.labelPosition},nativeOn:{submit:function(e){e.preventDefault()}}},[a("Row",{attrs:{type:"flex",gutter:24}},[a("Col",e._b({},"Col",e.grid,!1),[a("FormItem",{attrs:{label:"批次名称：","label-for":"title"}},[a("Input",{attrs:{search:"","enter-button":"",placeholder:"请输入批次名称"},on:{"on-search":e.userSearchs},model:{value:e.gradeFrom.title,callback:function(t){e.$set(e.gradeFrom,"title",t)},expression:"gradeFrom.title"}})],1)],1)],1),a("Row",{attrs:{type:"flex"}},[a("Col",e._b({},"Col",e.grid,!1),[a("Button",{staticClass:"mr20",attrs:{type:"primary",icon:"md-add"},on:{click:e.addBatch}},[e._v("添加批次")]),a("Button",{on:{click:e.getMemberScan}},[e._v("下载二维码")])],1)],1)],1),a("Table",{staticClass:"mt25",attrs:{columns:e.columns,data:e.tbody,loading:e.loading,"highlight-row":"","no-userFrom-text":"暂无数据","no-filtered-userFrom-text":"暂无筛选结果"},scopedSlots:e._u([{key:"status",fn:function(t){var r=t.row;t.index;return[a("i-switch",{attrs:{value:r.status,"true-value":1,"false-value":0,size:"large"},on:{"on-change":function(t){return e.onchangeIsShow(r)}},model:{value:r.status,callback:function(t){e.$set(r,"status",t)},expression:"row.status"}},[a("span",{attrs:{slot:"open"},slot:"open"},[e._v("激活")]),a("span",{attrs:{slot:"close"},slot:"close"},[e._v("冻结")])])]}},{key:"action",fn:function(t){var r=t.row,i=t.index;return[[a("Dropdown",{on:{"on-click":function(t){return e.changeMenu(r,t,i)}}},[a("a",{attrs:{href:"javascript:void(0)"}},[e._v("\n                            更多\n                            "),a("Icon",{attrs:{type:"ios-arrow-down"}})],1),a("DropdownMenu",{attrs:{slot:"list"},slot:"list"},[a("DropdownItem",{attrs:{name:"1"}},[e._v("编辑批次名")]),a("DropdownItem",{attrs:{name:"2"}},[e._v("查看卡列表")]),a("DropdownItem",{attrs:{name:"3"}},[e._v("导出")])],1)],1)]]}}])}),a("div",{staticClass:"acea-row row-right page"},[a("Page",{attrs:{total:e.total,current:e.gradeFrom.page,"page-size":e.gradeFrom.limit,"show-elevator":"","show-total":""},on:{"on-change":e.pageChange}})],1)],1),a("Modal",{attrs:{title:"添加批次","footer-hide":""},model:{value:e.modal,callback:function(t){e.modal=t},expression:"modal"}},[a("form-create",{attrs:{rule:e.rule},on:{"on-submit":e.onSubmit},model:{value:e.fapi,callback:function(t){e.fapi=t},expression:"fapi"}})],1),a("Modal",{attrs:{title:"编辑批次名","footer-hide":""},model:{value:e.modal2,callback:function(t){e.modal2=t},expression:"modal2"}},[a("form-create",{attrs:{rule:e.rule2},on:{"on-submit":e.onSubmit2}})],1),a("Modal",{attrs:{title:"二维码","footer-hide":""},model:{value:e.modal3,callback:function(t){e.modal3=t},expression:"modal3"}},[e.qrcode?a("div",{staticClass:"acea-row row-around"},[e.qrcode&&e.qrcode.wechat_img?a("div",{staticClass:"acea-row row-column-around row-between-wrapper"},[a("div",{directives:[{name:"viewer",rawName:"v-viewer"}],staticClass:"QRpic"},[a("img",{directives:[{name:"lazy",rawName:"v-lazy",value:e.qrcode.wechat_img,expression:"qrcode.wechat_img"}]})]),a("span",{staticClass:"mt10"},[e._v("公众号二维码")])]):e._e(),e.qrcode&&e.qrcode.routine?a("div",{staticClass:"acea-row row-column-around row-between-wrapper"},[a("div",{directives:[{name:"viewer",rawName:"v-viewer"}],staticClass:"QRpic"},[a("img",{directives:[{name:"lazy",rawName:"v-lazy",value:e.qrcode.routine,expression:"qrcode.routine"}]})]),a("span",{staticClass:"mt10"},[e._v("小程序二维码")])]):e._e()]):a("Spin")],1)],1)},i=[],o=(a("8e6e"),a("ac6a"),a("456d"),a("ade3")),s=a("2f62"),n=a("c24f");function l(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function c(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?l(Object(a),!0).forEach((function(t){Object(o["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var u={name:"index",data:function(){return{grid:{xl:7,lg:7,md:12,sm:24,xs:24},columns:[{title:"编号",key:"id"},{title:"批次名称",key:"title"},{title:"体验天数",key:"use_day"},{title:"发卡总数量",key:"total_num"},{title:"使用数量",key:"use_num"},{title:"制卡时间",key:"add_time"},{title:"是否激活",slot:"status"},{title:"备注",key:"remark"},{title:"操作",slot:"action",fixed:"right"}],tbody:[],total:0,gradeFrom:{title:"",page:1,limit:15},loading:!1,modal:!1,rule:[{type:"input",field:"title",title:"批次名称",validate:[{required:!0,message:"请输入批次名称",trigger:"blur"}]},{type:"InputNumber",field:"total_num",title:"制卡数量",value:1,props:{min:1}},{type:"InputNumber",field:"use_day",title:"体验天数",value:1,props:{min:1}},{type:"radio",field:"status",title:"是否激活",value:"0",options:[{value:"0",label:"冻结"},{value:"1",label:"激活"}]},{type:"input",field:"remark",title:"备注",props:{type:"textarea"}}],modal2:!1,rule2:[{type:"hidden",field:"id",value:""},{type:"input",field:"title",title:"批次名称",value:"",validate:[{required:!0,message:"请输入批次名称",trigger:"blur"}]}],modal3:!1,qrcode:null,fapi:{}}},computed:c(c({},Object(s["e"])("media",["isMobile"])),{},{labelWidth:function(){return this.isMobile?void 0:75},labelPosition:function(){return this.isMobile?"top":"right"}}),created:function(){this.getMemberBatch(this.gradeFrom)},methods:{getMemberBatch:function(){var e=this;this.loading=!0,Object(n["M"])(this.gradeFrom).then((function(t){e.loading=!1,e.tbody=t.data.list,e.total=t.data.count})).catch((function(t){e.loading=!1,e.$Message.error(t.msg)}))},userSearchs:function(){this.gradeFrom.page=1,this.getMemberBatch()},onchangeIsShow:function(e){var t=this;Object(n["s"])(e.id,{field:"status",value:e.status}).then((function(e){t.$Message.success(e.msg)})).catch((function(e){t.$Message.error(e.msg)}))},exportExcel:function(e){var t=this;this.$Spin.show(),Object(n["f"])(e.id).then((function(e){t.$Spin.hide(),location.href=e.data[0]})).catch((function(e){t.$Spin.hide(),t.$Message.error(e.msg)}))},changeMenu:function(e,t){switch(t){case"1":this.rule2[0].value=e.id,this.rule2[1].value=e.title,this.modal2=!0;break;case"2":this.$router.push({path:"/admin/user/grade/list/".concat(e.id)});break;case"3":this.exportExcel(e);break}},pageChange:function(e){this.gradeFrom.page=e,this.getMemberBatch()},addBatch:function(){this.fapi.resetFields(),this.modal=!0},onSubmit:function(e){var t=this;Object(n["r"])(0,e).then((function(e){t.modal=!1,t.$Message.success(e.msg),t.getMemberBatch(),t.fapi.resetFields()})).catch((function(e){t.$Message.error(e.msg)}))},onSubmit2:function(e){var t=this;Object(n["s"])(e.id,{field:"title",value:e.title}).then((function(e){t.modal2=!1,t.$Message.success(e.msg),t.getMemberBatch()})).catch((function(e){t.$Message.error(e.msg)}))},getMemberScan:function(){var e=this;this.$Spin.show(),Object(n["O"])().then((function(t){e.$Spin.hide(),e.qrcode=t.data,e.modal3=!0})).catch((function(t){e.$Spin.hide(),e.$Message.error(t.msg)}))}}},d=u,m=(a("9f7b"),a("2877")),p=Object(m["a"])(d,r,i,!1,null,"1968887c",null);t["default"]=p.exports},"9f7b":function(e,t,a){"use strict";var r=a("d562"),i=a.n(r);i.a},d562:function(e,t,a){}}]);